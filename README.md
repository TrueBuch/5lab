# ЛАБОРАТОРНАЯ РАБОТА №5
**Тема:** LINQ-ЗАПРОСЫ

---

База данных содержит информацию о:
- банковских счетах,
- поступлениях средств,
- курсах валют.

Данные хранятся в Excel-файле и представлены в программе в виде объектов соответствующих классов.

---

## Структура проекта

### Класс Account
Описание: хранит информацию о банковском счёте.

Свойства:
- ID — идентификатор счёта
- FullName — ФИО владельца
- OpenDate — дата открытия счёта

Методы:
- конструкторы инициализации
- ToString() — строковое представление объекта

---

### Класс Accrual
Описание: хранит информацию о поступлении средств.

Свойства:
- ID — идентификатор операции
- AccountID — идентификатор счёта
- CurrencyID — идентификатор валюты
- OperationDate — дата операции
- Amount — сумма поступления

---

### Класс CurrencyRate
Описание: хранит информацию о валюте и её курсе.

Свойства:
- ID — идентификатор валюты
- Code — буквенный код валюты
- Name — полное наименование
- Rate — курс валюты

---

## Функциональные возможности приложения

### 1. Чтение базы данных из Excel-файла
Приложение загружает данные из Excel-файла и формирует внутреннюю структуру базы данных.

Используется библиотека Aspose.Cells.

---

### 2. Просмотр базы данных
Пользователь может выбрать таблицу:
- счета,
- поступления,
- курсы валют,

и просмотреть её содержимое в консоли в табличном виде.

---

### 3. Добавление элементов
Реализовано добавление новых записей в каждую из таблиц:
- создание счёта,
- добавление поступления,
- добавление курса валюты.

Идентификаторы генерируются автоматически.

---

### 4. Удаление элементов
Удаление записей производится по ключу ID для выбранной таблицы.

---

### 5. LINQ-запросы

В программе реализованы четыре LINQ-запроса, соответствующие требованиям задания.

---

#### Запрос 1 — работа с одной таблицей
Описание:
Получить список счетов, открытых после заданной даты.

Используемая таблица: Account
Результат: перечень объектов

---

#### Запрос 2 — работа с двумя таблицами
Описание:
Определить общую сумму начислений по выбранному счёту.

Используемые таблицы: Account, Accrual
Результат: одно числовое значение

---

#### Запрос 3 — работа с тремя таблицами
Описание:
Определить сумму средств в рублях по каждому владельцу счёта.

Используемые таблицы: Account, Accrual, CurrencyRate
Результат: перечень значений

---

#### Запрос 4 — работа с тремя таблицами
Описание:
Найти владельца счёта с максимальной суммой средств в рублях за указанный период.

Используемые таблицы: Account, Accrual, CurrencyRate
Результат: одно значение

---

### 6. Сохранение данных в Excel
После внесения изменений пользователь может сохранить актуальное состояние базы данных обратно в Excel-файл.

---

## Обработка ошибок

В программе предусмотрена обработка возможных ошибок:
- проверка загрузки базы данных перед выполнением операций,
- проверка корректности пользовательского ввода,
- проверка существования связанных записей,
- контроль форматов даты и числовых значений.

---

## Используемые технологии

- Язык программирования: C#
- Тип приложения: консольное
- Работа с Excel: Aspose.Cells
- Запросы к данным: LINQ
- Хранение данных: коллекции List<T>, Dictionary<Type, IList>

---

## Вывод

В ходе выполнения лабораторной работы было разработано консольное приложение для работы с базой данных, хранящейся в Excel-файле.
Программа удовлетворяет всем требованиям задания и демонстрирует навыки работы с коллекциями, LINQ-запросами, обработкой данных и внешними библиотеками.
